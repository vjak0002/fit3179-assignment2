<!DOCTYPE html>
<html>
  <head>
    <meta charset="utf-8" />
    <title>FIT3179 Visualisation 2</title>

    <link rel="stylesheet" href="" />
    <script src="https://cdn.jsdelivr.net/npm/vega@5.20.2"></script>
    <script src="https://cdn.jsdelivr.net/npm/vega-lite@5.5.0"></script>
    <script src="https://cdn.jsdelivr.net/npm/vega-embed@6.17.0"></script>
    <script src="https://cdn.jsdelivr.net/npm/vega-tooltip@0.28.0"></script>

    <link rel="stylesheet" href="css/index.css" />
  </head>
  <body>
    <div id="page-loader"></div>

    <div class="viz-grid">
      <div class="viz-row">
        <div id="viz-title">
          <h1>World Happiness Report</h1>
        </div>
      </div>

      <div class="viz-row" id="viz-intro-row">
        <div id="viz-intro">
          <p>
            World Happiness Report is a survey of the state of global happiness
            that ranks 146 countries by how happy their citizens perceive
            themselves to be. The Happiness Index is a score between 0 and 10,
            with 10 being the happiest.
          </p>
        </div>
      </div>

      <div class="viz-row" id="map-box">
        <div id="map-viz"></div>

        <div id="map-viz-footer">
          <span id="country-rank"></span>
          <span id="country-name"></span>
          <span id="country-score"></span>
        </div>

        <!-- <div class="viz-annotations" id="na-annotations-img">
          <img src="./assets/na-annotation.png" alt="" />
        </div>
        <div class="viz-annotations" id="na-annotations-text">
          <b>CANADA</b> is the happiest <br />
          country in <b>NORTH AMERICA</b>
          higher than global average
        </div>

        <div class="viz-annotations" id="ua-annotations-img">
          <img src="./assets/ua-annotation.png" alt="" />
        </div>
        <div class="viz-annotations" id="ua-annotations-text">
          <b>UKRAINE</b> is the unhappiest <br />
          country in <b>EUROPE</b>
        </div>

        <div class="viz-annotations" id="nz-annotations-img">
          <img src="./assets/nz-annotation.png" alt="" />
        </div>
        <div class="viz-annotations" id="nz-annotations-text">
          <b>NEW ZEALAND</b> is the happiest<br />
          country in <b>OCEANIA</b>
        </div> -->
      </div>

      <div class="viz-row" id="viz-text-row">
        <div class="viz-text">
          <b>Dystopia</b> is a combination of two Greek words 'dys' meaning
          <b>bad</b> and 'topos' meaning <b>place</b>. In this context, Dystopia
          refers to an <b>imaginary country</b> that has the
          <b>unhappiest people</b> in the world. <b>Residual</b> is the
          <b>unexplained</b> variance in the Happiness Index.
        </div>
      </div>

      <div class="viz-row">
        <div id="viz-1"></div>
        <div id="viz-1-2-text">
          The bar chart on the left shows the top 10 happiest countries and
          compares various factors which contribute to the happiness index.<br />
          ----------------- <br />The bar chart on the right shows the top 10
          unhappiest countries and compares various factors which contribute to
          the happiness index.
        </div>
        <div id="viz-2"></div>
      </div>

      <div class="viz-row" id="viz-text-row">
        <div class="viz-text">
          As seen from above, the top 10 happiest countries have a higher
          <b>social support</b> and <b>freedom</b> than the top 10 unhappiest
          countries. <br />

          <br />
          <b>Generosity</b> and <b>Corruption</b> are the two factors that
          contribute the least to the happiness index.
        </div>
      </div>

      <div class="viz-row">
        <div id="viz-3">viz 3 here</div>
        <div id="viz-3-4-text">middle text here</div>
        <div id="viz-4">viz 4 here</div>
      </div>
    </div>

    <script type="text/javascript">
      document.addEventListener("DOMContentLoaded", () => {
        setTimeout(() => {
          document.getElementById("page-loader").style.display = "none";
        }, 50);
      });

      vegaEmbed("#map-viz", "js/countries_map.vg.json", {
        tooltip: {
          theme: "dark",
        },
      })
        .then(function (result) {
          result.view.addEventListener("mouseover", function (event, item) {
            console.log("CLICK", item.datum);
            if (item.datum.country != null) {
              document.getElementById("map-viz-footer").style.display = "block";
            } else {
              document.getElementById("map-viz-footer").style.display = "none";
            }
            document.getElementById("country-rank").innerHTML =
              "<b>Rank</b>: " + item.datum.rank;
            document.getElementById("country-name").innerHTML =
              "<b>Name</b>: " + item.datum.country;
            document.getElementById("country-score").innerHTML =
              "<b>Happiness Index</b>: " + item.datum.score;
          });
        })
        .catch(console.error);

      // vega.expressionFunction("customFormat", function (datum, params) {
      //   return "<b>datum</b>";
      // });

      vegaEmbed("#viz-1", "js/stacked-top-10.vg.json")
        .then(function (result) {})
        .catch(console.error);

      vegaEmbed("#viz-2", "js/stacked-bottom-10.vg.json")
        .then(function (result) {})
        .catch(console.error);
    </script>
  </body>
</html>
